"0","gibbsReffects=function(N,initial,priorparam,m,n,ybar,s)"
"0","{"
"0","  a=priorparam[1];b=priorparam[2];c=priorparam[3];d=priorparam[4];e=priorparam[5];f=priorparam[6]"
"0","  output=matrix(ncol=m+3,nrow=N)"
"0","  colnames(output)=c(""mu"",""tau"",""nu"",paste(""theta"", 1:m, sep=""""))"
"0","  theta=vector(""numeric"",length=m)"
"0","  mu=initial[1]; tau=initial[2]; nu=initial[3]"
"0","    for (j in 1:m) {theta[j]=ybar[j]}"
"0","    output[1,]=c(mu,tau,nu,theta)"
"0","    for (j in 2:N) {"
"0","        muprec=b+m*nu"
"0","        mumean=(a*b+m*nu*mean(theta))/muprec"
"0","        mu=rnorm(1,mumean,1/sqrt(muprec))"
"0","        tauh=d+0.5*sum(n*(s^2+(ybar-theta)^2))"
"0","        tau=rgamma(1,c+sum(n)/2,tauh)"
"0","        nuh=f+0.5*sum((theta-mu)^2)"
"0","        nu=rgamma(1,e+m/2,nuh)"
"0","        for (i in 1:m) {"
"0","            thetaiprec=nu+n[i]*tau"
"0","            thetaimean=(nu*mu+n[i]*ybar[i]*tau)/thetaiprec"
"0","            theta[i]=rnorm(1,thetaimean,1/sqrt(thetaiprec))"
"0","        }"
"0","        output[j,]=c(mu,tau,nu,theta)"
"0","    }"
"0","    output"
"0","}"
"0",""
