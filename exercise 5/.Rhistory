Energy <- read.delim("C:/Users/Aleksi/Desktop/KOulu/Simulation Methods/Exercises/exercise 5/mcsm/mcsm/data/Energy.txt")
View(Energy)
knitr::opts_chunk$set(echo = TRUE)
head(Energy)
View(Energy)
x1 <- Energy[1]
x1
x2
x2 <- Energy[2]
x2
gibbsReffects=function(N,initial,priorparam,m,n,ybar,s)
{
a=priorparam[1];b=priorparam[2];c=priorparam[3];d=priorparam[4];e=priorparam[5];f=priorparam[6]
output=matrix(ncol=m+3,nrow=N)
colnames(output)=c("mu","tau","nu",paste("theta", 1:m, sep=""))
theta=vector("numeric",length=m)
mu=initial[1]; tau=initial[2]; nu=initial[3]
for (j in 1:m) {theta[j]=ybar[j]}
output[1,]=c(mu,tau,nu,theta)
for (j in 2:N) {
muprec=b+m*nu
mumean=(a*b+m*nu*mean(theta))/muprec
mu=rnorm(1,mumean,1/sqrt(muprec))
tauh=d+0.5*sum(n*(s^2+(ybar-theta)^2))
tau=rgamma(1,c+sum(n)/2,tauh)
nuh=f+0.5*sum((theta-mu)^2)
nu=rgamma(1,e+m/2,nuh)
for (i in 1:m) {
thetaiprec=nu+n[i]*tau
thetaimean=(nu*mu+n[i]*ybar[i]*tau)/thetaiprec
theta[i]=rnorm(1,thetaimean,1/sqrt(thetaiprec))
}
output[j,]=c(mu,tau,nu,theta)
}
output
}
Nsim <- 11000
init <- c(0,0,0)
m <- 2
n <- c(16,16)
ybar <- c(mean(Energy[1]), mean(Energy[2]))
ysd <- c(sd(Energy[1]), sd(Energy[2]))
Energy[1]
sd(Energy[1])
mean(Energy[1])
ybar <- c(mean(Energy[1]), mean(Energy[2]))
ysd <- c(sd(Energy[1]), sd(Energy[2]))
energy <- as.matrix(Energy)
Nsim <- 11000
init <- c(0,0,0)
m <- 2
n <- c(16,16)
energy <- as.matrix(Energy)
ybar <- c(mean(energy[1]), mean(energy[2]))
ysd <- c(sd(energy[1]), sd(energy[2]))
energy[1])
energy[1]
energy[1,]
energy[,1]
ybar <- c(mean(energy[, 1]), mean(energy[, 2]))
ysd <- c(sd(energy[, 1]), sd(energy[, 2]))
energy[, 2]
Nsim <- 11000
init <- c(0,0,0)
m <- 2
n <- c(16,16)
energy <- as.matrix(Energy)
ybar <- c(mean(energy[, 1]), mean(energy[, 2]))
ysd <- c(sd(energy[, 1]), sd(energy[, 2]))
gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
n = m,
ybar = ybar,
s = ysd)
Nsim <- 11000
init <- c(0,0,0)
m <- 2
n <- c(16,16)
energy <- as.matrix(Energy)
ybar <- c(mean(energy[, 1]), mean(energy[, 2]))
ysd <- c(sd(energy[, 1]), sd(energy[, 2]))
gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
n = m,
ybar = ybar,
s = ysd)
m
gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
m = m,
n = n,
ybar = ybar,
s = ysd)
results <- gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
m = m,
n = n,
ybar = ybar,
s = ysd)
results[1:20,]
#omit first thoushand as burn in
results <- results[10^3:11*10^3,]
results[10^3:11*10^3,]
#omit first thoushand as burn in
results <- results[10^3,]
results <- gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
m = m,
n = n,
ybar = ybar,
s = ysd)
#omit first thoushand as burn in
results[10^3:2*10^3,]
#omit first thoushand as burn in
nrow(results)
results[1000]
results[1000,]
results[1000:1100,]
results[1000:10999,]
results <- results[1000:10999,]
hist(results)
results[,1]
hist(results[,1])
hist(results[,1])
hist(results[,2])
hist(results[,3])
hist(results[,4])
results <- gibbsReffects(N = Nsim,
initial = init,
priorparam = c(1,4,1,4,1,4),
m = m,
n = n,
ybar = ybar,
s = ysd)
head(results)
results <- data.frame(results)
results
hist(results)
results
hist(results$mu)
hist(results$mu)
hist(results$tau)
hist(results$nu)
hist(results$theta1)
hist(results$theta2)
#omit first thoushand as burn in
results <- results[1000:10999,]
results <- data.frame(results)
