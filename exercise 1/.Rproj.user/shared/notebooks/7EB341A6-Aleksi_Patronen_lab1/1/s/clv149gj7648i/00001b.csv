"0","library(ggplot2)"
"0","n <- 10^5 # number of observations simulated"
"0","seed <- 1234 # seed for reproducability"
"0","Box_muller <- function(n, mu, sigma, seed){"
"0","  set.seed(seed)"
"0","  samples <- matrix(ncol = 2, nrow = n) # create a matrix where samples will be stored"
"0","   for (i in c(1:n)){ # for loop 1 -> n"
"0","     u1 <- runif(1) # sample u1 from uniform "
"0","     u2 <- runif(1) # sample u2 from uniform "
"0","     R <- sqrt(-2*log(1 - u1)) # calculate the fist part of the norm equation"
"0","     theta <- 2*pi*u2 # the second part  as tabulated in table 6.1 in the book"
"0","     X <- R*cos(theta) # make two variables x and y"
"0","     Y <- R*sin(theta) # both of wich are normally distributed i.i.d"
"0","     samples[i,1] <- X # pack both of the variables into the matrix     "
"0","     samples[i,2] <- Y # created earlier."
"0","   }"
"0","  return(samples)  # return samples"
"0","}"
"0",""
"0",""
"0",""
"0","results <- Box_muller(n, mu = 0, sigma = 1, seed) # call for the functions"
"0","hist(results[,1]) # lets hist's"
