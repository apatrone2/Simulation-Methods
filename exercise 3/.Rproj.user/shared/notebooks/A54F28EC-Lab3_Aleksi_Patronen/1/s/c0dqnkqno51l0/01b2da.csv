"0","set.seed(12345)"
"0","run <- rbinom(ptot,1,.5) # SAMPLE INDICATOR FOR PREDICTORS"
"0","run.current <- run"
"0","run.vars <- pred[,run.current==1] #SELECT PREDICTORS BASED ON INDICATORS"
"0","run.vars <- as.matrix(run.vars)"
"0","y <- as.matrix(y)"
"0","f <- lm(y ~ run.vars)# INITIAL LINEAR MODEL"
"0","#run.bic <- BIC(f)[2] # EXTRACT BIC"
"0","run.bic <- BIC(f) # EXTRACT BIC"
"0","best.bic <- run.bic"
"0","bics <- run.bic"
"0",""
"0",""
"0","positions <- matrix(ncol = ptot, nrow=1600)"
"0","k = 1"
"0","positions[k,] <- run"
"0","for(j in 2:13){tau[j] <- 0.9*tau[j-1]} #TEMP SCHEDULE 15 LEVELS"
"0","  ## SIMULATED ANNEALING"
"0",""
"0","for(j in 1:13){# RANDOMLY SELECTS A PREDICTOR TO ADD/REMOVE FROM THE MODEL"
"0","  # AND ACCEPTS THE NEW MODEL IF IT IS BETTER OR WITH PROBABILITY prob"
"0","  for(i in 1:m[j]){"
"0","    pos <- sample(1:ptot,1)"
"0","    run.step <- run.current"
"0","    k = k + 1"
"0","    positions[k,] <- run.step"
"0","    "
"0","    run.step[pos] <- !run.current[pos]"
"0","    run.vars <- pred[,run.step==1]"
"0","    run.vars <- as.matrix(run.vars)"
"0","    y <- as.matrix(y)"
"0","    f <- lm(y ~ run.vars)"
"0","    run.step.bic <- BIC(f)"
"0","    prob <- min(1,exp((run.bic - BIC(f))/tau[j]))"
"0","    "
"0","    #print(run.step.bic)"
"0","    if(run.step.bic < run.bic){"
"0","      run.current <- run.step"
"0","      run.bic <- run.step.bic"
"0","      }"
"0","    if(rbinom(1,1,prob)){"
"0","      run.current <- run.step"
"0","      run.bic <- run.step.bic"
"0","      }"
"0","    if(run.step.bic < best.bic){ #ACCEPT IF BETTER THAN CURRENT BEST"
"0","      run <- run.step"
"0","      best.bic <- run.step.bic"
"0","    }"
"0","    bics <- c(bics, run.bic)"
"0","    #pos[,k] <- pos"
"0","  }"
"0","  "
"0","}"
"0",""
